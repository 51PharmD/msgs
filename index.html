<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anonymous Messages</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .message { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; background: #f9f9f9; }
        iframe { border: none; width: 100%; height: 500px; }
    </style>
</head>
<body>
    <h1>Anonymous Messages</h1>
    <div id="messages"></div>
    <h2>Submit a Message</h2>
    <iframe src="https://forms.gle/SdR5MshYBk5wCd1G8"></iframe>
    <script>
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQazrkD8DxsLDMhQ4X78vjlIjq1wos7C-0dge7NDG0EBkJ7jhePsJYXCGUvMV79GaNcAa1hJYS_M-5Z/pubhtml';
        const sheetId = sheetUrl.match(/[-\w]{25,}/);

        if (sheetId) {
            const jsonUrl = `https://spreadsheets.google.com/feeds/list/${sheetId[0]}/od6/public/values?alt=json`;

            console.log('Fetching data from:', jsonUrl); // Log the URL to confirm it's correct

            fetch(jsonUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Data fetched:', data); // Log the data fetched
                    const messages = data.feed.entry;
                    const messagesDiv = document.getElementById('messages');
                    messages.forEach(entry => {
                        const messageText = entry.gsx$message.$t;
                        const signature = entry.gsx$signature.$t;

                        console.log('Message:', messageText, 'Signature:', signature); // Log each message

                        const messageDiv = document.createElement('div');
                        messageDiv.className = 'message';
                        messageDiv.innerHTML = `<p>${messageText}</p><p><em>${signature ? '-' + signature : ''}</em></p>`;
                        messagesDiv.appendChild(messageDiv);
                    });
                })
                .catch(error => console.error('Error fetching data:', error));
        } else {
            console.error('Invalid Google Sheets URL');
        }
    </script>
</body>
</html>
